<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<testcase testfamily="end2end_device" testgroup="credentials" testcase="08_add_credential_en" parallel="false" location="${location}" workflowpause="0" customerid='${customerid}'>
<meta>{ "mac" : "${mac}", "customer" : "98746.8785.t5a.l1.cisco.com", "pidvid": "${pidvid}",  "driver": "${driver}"} </meta>
    <workflow driver="imacros" stoptype="abort" wfid="DT1_IMACRO_CREDENTIAL_${mac_no_colon}">
<!--Login and go to topology page -->
    <action acid="1" stoptype="abort" timeout="10">
      <actionname>navigate</actionname>
      <actionparam paramtype="url" paramvalue="https://${location}"/>
    </action>
    <action acid="2" stoptype="abort" timeout="10">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice"/>
    </action>
    <action acid="3" stoptype="abort" timeout="10">
      <actionname>input</actionname>
      <actionparam paramtype="image" paramvalue="LoginDevice_Username"/>
      <actionparam paramtype="text" paramvalue="${agentname}"/>
    </action>
    <action acid="4" stoptype="abort" timeout="10">
      <actionname>input</actionname>
      <actionparam paramtype="image" paramvalue="LoginDevice_Password"/>
      <actionparam paramtype="text" paramvalue="${password}"/>
    </action>
    <action acid="5" stoptype="abort" timeout="10">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_LogIn"/>
    </action>
    <action acid="6" stoptype="abort" timeout="10">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="Login_Overview"/>
    </action>
    <action acid="7" stoptype="abort" timeout="5">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="text"/>
      <actionparam paramtype="value" paramvalue="${agentcustomername}"/>
    </action>
<!--Site Up Check -->
	<action acid="55" stoptype="abort" timeout="20">
        <actionname>wait</actionname>
        <actionparam paramtype="value" paramvalue="10"/>
    </action>
    <action acid="8" stoptype="abort" timeout="10">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_Status"/>
    </action>
    <action acid="9" stoptype="abort" timeout="10">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_Status_ActivatedOnLine"/>
    </action>
<!--Device up Check -->
    <action acid="10" stoptype="abort" timeout="10">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_Dashboard"/>
    </action>
	<action acid="56" stoptype="abort" timeout="20">
        <actionname>wait</actionname>
        <actionparam paramtype="value" paramvalue="10"/>
    </action>
    <action acid="11" stoptype="abort" timeout="10">
      <actionname>multiclick</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value1" paramvalue="LoginDevice_Topology_FilterCriteria"/>
      <actionparam paramtype="value2" paramvalue="LoginDevice_Topology_FilterCriteria_Clearallsearchcriteria"/>
      <actionparam paramtype="value3" paramvalue="LoginDevice_Topology_FilterCriteria_MACAddressContaining_checkbox"/>
    </action>
    <action acid="12" stoptype="abort" timeout="10">
      <actionname>clickinput</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_FilterCriteria"/>
      <actionparam paramtype="image" paramvalue="LoginDevice_Topology_FilterCriteria_MACAddressContaining"/>
      <actionparam paramtype="text" paramvalue="${mac}"/>
    </action>
    <action acid="13" stoptype="abort" timeout="10">
      <actionname>multiclick</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value1" paramvalue="LoginDevice_Topology_FilterCriteria"/>
      <actionparam paramtype="value2" paramvalue="LoginDevice_Topology_FilterCriteria_MACAddressContaining_ApplySearch"/>
    </action>
    <action acid="14" stoptype="abort" timeout="10">
      <actionname>multildownlup</actionname>
      <actionparam paramtype="type" paramvalue="ACTION"/>
      <actionparam paramtype="X1" paramvalue="200"/>
      <actionparam paramtype="Y1" paramvalue="300"/>
      <actionparam paramtype="X2" paramvalue="80"/>
      <actionparam paramtype="Y2" paramvalue="300"/>
    </action>
    <action acid="15" stoptype="abort" timeout="10">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_DeviceListing"/>
    </action>
    <action acid="16" stoptype="abort" timeout="10">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_DeviceListing_StateOK"/>
    </action>
<!-- Driver Selected Check -->
    <action acid="17" stoptype="abort" timeout="10" loop="1" iterations ="3" sleep="2" break="Y">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Statusok"/>
    </action>
    <action acid="18" stoptype="abort" timeout="10" loop="1">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Popup"/>
    </action>
    <action acid="19" stoptype="abort" timeout="10">
      <actionname>goto</actionname>
      <actionparam paramtype="type" paramvalue="tab"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Credentials"/>
    </action>
    <action acid="20" stoptype="abort" timeout="5">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_DeviceDriver"/>
    </action>
    <action acid="20" stoptype="abort" timeout="5">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_DeviceDriver_DiscoveredDriver"/>
    </action>
<!-- Login Creds Add -->
    <action acid="21" stoptype="abort" timeout="5">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess"/>
    </action>
        <action acid="15" stoptype="continue" timeout="5">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess_DeleteExistingCredentials"/>
        </action>
    <action acid="21" stoptype="abort" timeout="5">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_EnableAccess"/>
    </action>
        <action acid="15" stoptype="continue" timeout="5">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess_DeleteExistingCredentials"/>
        </action>
        <action acid="16" stoptype="abort" timeout="10">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Debug_Ok"/>
        </action>
        <action acid="17" stoptype="abort" timeout="20">
            <actionname>wait</actionname>
            <actionparam paramtype="value" paramvalue="1"/>
        </action>
    <action acid="17" stoptype="abort" timeout="10" loop="2" iterations ="3" sleep="2" break="Y">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Statusok"/>
    </action>
    <action acid="18" stoptype="abort" timeout="10" loop="2">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Popup"/>
    </action>
        <action acid="20" stoptype="abort" timeout="10">
            <actionname>goto</actionname>
            <actionparam paramtype="type" paramvalue="tab"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials"/>
        </action>
        <action acid="21" stoptype="abort" timeout="5">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess"/>
        </action>
        <action acid="22" stoptype="continue" timeout="3">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Credentials_LoginAccess_Condition_UserId"/>
            <actionparam paramtype="text" paramvalue="portal"/>
        </action>
        <action acid="23" stoptype="continue" timeout="3">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Credentials_LoginAccess_Condition_Password"/>
            <actionparam paramtype="text" paramvalue="Portal123"/>
        </action>
        <action acid="24" stoptype="continue" timeout="3">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Credentials_LoginAccess_UserId"/>
            <actionparam paramtype="text" paramvalue="portal"/>
        </action>
        <action acid="25" stoptype="continue" timeout="3">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Credentials_LoginAccess_Password"/>
            <actionparam paramtype="text" paramvalue="Portal123"/>
        </action>
        <action acid="21" stoptype="abort" timeout="5">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_EnableAccess"/>
        </action>
        <action acid="24" stoptype="continue" timeout="3">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Credentials_EnableAccess_Condition_Password"/>
            <actionparam paramtype="text" paramvalue="Portal123"/>
        </action>
        <action acid="24" stoptype="continue" timeout="3">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Credentials_EnableAccess_Password"/>
            <actionparam paramtype="text" paramvalue="Portal123"/>
        </action>
        <action acid="26" stoptype="abort" timeout="10">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Debug_Ok"/>
        </action>
        <action acid="27" stoptype="abort" timeout="10">
            <actionname>verify</actionname>
            <actionparam paramtype="type" paramvalue="visual"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Tool"/>
        </action>
        <action acid="28" stoptype="abort" timeout="5">
            <actionname>multiclick</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value1" paramvalue="LoginDevice_Tool"/>
            <actionparam paramtype="value2" paramvalue="LoginDevice_Tool_CiscoSupport"/>
            <actionparam paramtype="value3" paramvalue="LoginDevice_Tool_CiscoSupport_Access"/>
        </action>
        <action acid="29" stoptype="abort" timeout="10">
            <actionname>verify</actionname>
            <actionparam paramtype="type" paramvalue="visual"/>
            <actionparam paramtype="value" paramvalue="GoToTab_Tool_CiscoSupport_Password"/>
        </action>
        <action acid="30" stoptype="continue" timeout="5">
            <actionname>ds</actionname>
            <actionparam paramtype="type" paramvalue="MOVETO"/>
            <actionparam paramtype="X" paramvalue="610"/>
            <actionparam paramtype="Y" paramvalue="545"/>
        </action>
        <action acid="31" stoptype="abort" timeout="10">
            <actionname>input</actionname>
            <actionparam paramtype="image" paramvalue="LoginDevice_Tool_CiscoSupport_Password"/>
            <actionparam paramtype="text" paramvalue="We8Turkey"/>
        </action>
        <action acid="32" stoptype="abort" timeout="5" loop="3" iterations ="2" sleep="60" break="N">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Tool_CiscoSupport_Access_NewTask"/>
        </action>
        <action acid="33" stoptype="abort" timeout="5" loop="3" >
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Tool_CiscoSupport_Access_NewTask_Selected"/>
        </action>
        <action acid="24" stoptype="abort" timeout="2">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Popup_Close"/>
        </action>
        <action acid="34" stoptype="abort" timeout="20">
            <actionname>wait</actionname>
            <actionparam paramtype="value" paramvalue="5"/>
        </action>
        <action acid="24" stoptype="abort" timeout="2" loop="4" iterations ="12" sleep="30" break="Y">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="Login_Home"/>
        </action>
    <action acid="7" stoptype="abort" timeout="5" loop="4">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="text"/>
      <actionparam paramtype="value" paramvalue="${agentcustomername}"/>
    </action>
    <action acid="10" stoptype="abort" timeout="10" loop="4">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_Dashboard"/>
    </action>
	<action acid="57" stoptype="abort" timeout="20">
        <actionname>wait</actionname>
        <actionparam paramtype="value" paramvalue="10"/>
    </action>
    <action acid="11" stoptype="abort" timeout="10" loop="4">
      <actionname>multiclick</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value1" paramvalue="LoginDevice_Topology_FilterCriteria"/>
      <actionparam paramtype="value2" paramvalue="LoginDevice_Topology_FilterCriteria_Clearallsearchcriteria"/>
      <actionparam paramtype="value3" paramvalue="LoginDevice_Topology_FilterCriteria_MACAddressContaining_checkbox"/>
    </action>
    <action acid="12" stoptype="abort" timeout="10" loop="4">
      <actionname>clickinput</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_FilterCriteria"/>
      <actionparam paramtype="image" paramvalue="LoginDevice_Topology_FilterCriteria_MACAddressContaining"/>
      <actionparam paramtype="text" paramvalue="${mac}"/>
    </action>
    <action acid="13" stoptype="abort" timeout="10" loop="4">
      <actionname>multiclick</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value1" paramvalue="LoginDevice_Topology_FilterCriteria"/>
      <actionparam paramtype="value2" paramvalue="LoginDevice_Topology_FilterCriteria_MACAddressContaining_ApplySearch"/>
    </action>
    <action acid="14" stoptype="abort" timeout="10" loop="4">
      <actionname>multildownlup</actionname>
      <actionparam paramtype="type" paramvalue="ACTION"/>
      <actionparam paramtype="X1" paramvalue="200"/>
      <actionparam paramtype="Y1" paramvalue="300"/>
      <actionparam paramtype="X2" paramvalue="80"/>
      <actionparam paramtype="Y2" paramvalue="300"/>
    </action>
    <action acid="15" stoptype="abort" timeout="10" loop="4">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Topology_DeviceListing"/>
    </action>
    <action acid="17" stoptype="abort" timeout="10" loop="4">
      <actionname>click</actionname>
      <actionparam paramtype="type" paramvalue="button"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Statusok"/>
    </action>
    <action acid="18" stoptype="abort" timeout="10" loop="4">
      <actionname>verify</actionname>
      <actionparam paramtype="type" paramvalue="visual"/>
      <actionparam paramtype="value" paramvalue="LoginDevice_Popup"/>
    </action>
        <action acid="36" stoptype="abort" timeout="10" loop="4">
            <actionname>goto</actionname>
            <actionparam paramtype="type" paramvalue="tab"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials"/>
        </action>
        <action acid="37" stoptype="abort" timeout="5" loop="4">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess"/>
        </action>
        <action acid="38" stoptype="abort" timeout="10" loop="4">
            <actionname>verify</actionname>
            <actionparam paramtype="type" paramvalue="visual"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess_AllowYes"/>
        </action>
        <action acid="40" stoptype="abort" timeout="10" loop="4">
            <actionname>verify</actionname>
            <actionparam paramtype="type" paramvalue="visual"/>
            <actionparam paramtype="value" paramvalue="LoginDevice_Credentials_LoginAccess_CredentialsWorkedLastAttempt"/>
        </action>
     <action acid="24" stoptype="continue" timeout="2" loop="4">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
           <actionparam paramtype="value" paramvalue="LoginDevice_Popup_Close"/>
     </action>
     <action acid="24" stoptype="continue" timeout="2" loop="4">
            <actionname>click</actionname>
            <actionparam paramtype="type" paramvalue="button"/>
           <actionparam paramtype="value" paramvalue="LoginDevice_Popup_Close"/>
     </action>
    </workflow>
</testcase>
