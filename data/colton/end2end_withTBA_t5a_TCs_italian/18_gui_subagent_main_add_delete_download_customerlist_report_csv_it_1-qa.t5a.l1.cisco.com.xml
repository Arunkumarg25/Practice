<?xml version="1.0" encoding="UTF-8"?>
<testcase testfamily="end2end_gui" testgroup="subagent" testcase="18_add_delete_report_csv_it" parallel="false" workflowpause="0" location="1-qa.t5a.l1.cisco.com" customerid="e2e.1-qa.t5a.l1.cisco.com">
<workflow driver="selenium" wfid="add_delete_report_csv" stoptype="abort" profile="italian" browser="firefox" rid="rantao">
<!--
	1. Log in;
	2. Navigate to the Report Page;
	3. Click "Create Report";
	4. Select "Customer List";
	5. Select "CSV";
	6. Select "English"
	7. Input Test123!@# into the text field of "Cover Page Notes"; 
	8. Click "Next";
	9. Click "Next" again and do not select any options;
	10. Select "Now" and Click "Save";
	11. Click "Save";
	12. Click "Close";
	13. Wait for 30 seconds;
	14. Redirect to the report page;
	15. Verify whether the report has been generated and verify all the info including notes are correct. 
	16. Verify preview page;
	17. Click the report that was just generated;
	18. Click "Delete";
	19. Click "OK";
	20. Redirect to the report page;
	21. Verify whether the report has been deleted.
  -->  
<action acid="1" stoptype="abort" timeout="10">
  <actionname>navigate</actionname> 
  <actionparam paramtype="url" paramvalue="https://www.t5a.l1.cisco.com" /> 
  </action>
 <!-- Log in input --> 
 <action acid="2" stoptype="abort" timeout="3">
  <actionname>input</actionname> 
  <actionparam paramtype="type" paramvalue="text field" /> 
  <actionparam paramtype="xpath" paramvalue="//*[@id='accountid']" /> 
  <actionparam paramtype="value" paramvalue="auto_var3_subagent1_it" /> 
  </action>
 <action acid="3" stoptype="abort" timeout="3">
  <actionname>input</actionname> 
  <actionparam paramtype="type" paramvalue="text field" /> 
  <actionparam paramtype="xpath" paramvalue="//*[@id='password']" /> 
  <actionparam paramtype="value" paramvalue="Test1234" /> 
  </action>
 <action acid="4" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="//*[@id='loginbutton']" /> 
  </action>
 <action acid="5" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="3" /> 
  </action> 
 
 <!--Navigate to the report page-->
 <action acid="6" stoptype="abort" timeout="30">
  <actionname>hover</actionname> 
  <actionparam paramtype="type" paramvalue="italianmenu" /> 
  <actionparam paramtype="value" paramvalue="Report" />  
  </action>
  <action acid="7" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="2" />  
  </action>
  <action acid="8" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="submenu" /> 
  <actionparam paramtype="value" paramvalue="Elenco rapporti" />  
  </action>
  <action acid="9" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="2" />  
  </action>
  
 <!--Click create report-->
<action acid="10" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="//*[@id='report_create']" />  
  </action>
  <action acid="11" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="1" />  
  </action>
   
  <!--Report--> 
  <action acid="12" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[2]/div/div/div/div/select/option" />  
  </action> 
      
  <!--Report format-->
  <action acid="13" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[2]/div/div/div/div[3]/select/option[2]" />  
  </action>  
  
  <!--Prefered Language-->
  <action acid="14" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[2]/div/div/div/div[4]/select/option[3]" />
  </action> 
  
  <!--Input Notes-->
  <action acid="15" stoptype="abort" timeout="30">
  <actionname>input</actionname> 
  <actionparam paramtype="type" paramvalue="text field" /> 
  <actionparam paramtype="xpath" paramvalue="//*[@id='report_notes']" />  
  <actionparam paramtype="value" paramvalue="123abcABC" />
  </action>   
   
  <!--Next-->
  <action acid="16" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[3]/div/span[2]/button" />  
  </action>  
  
  <!--Next without any options-->
  <action acid="17" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[3]/div/span[2]/button" />  
  </action> 

  <!--Create report Now-->
  <action acid="18" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[2]/div/div/div[3]/div/select/option" />  
  </action> 

  <!--Create save-->
  <action acid="19" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[3]/div/span[3]/button" />  
  </action>   
  <action acid="20" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="3" />  
  </action>
  
  <!--Create close-->
  <action acid="21" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[3]/div/button" />  
  </action> 
  
  <action acid="22" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="15" />  
  </action>
  
 <!--Navigate to the report page-->
 <action acid="23" stoptype="abort" timeout="30">
  <actionname>hover</actionname> 
  <actionparam paramtype="type" paramvalue="italianmenu" /> 
  <actionparam paramtype="value" paramvalue="Report" />  
  </action>
  <action acid="24" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="2" />  
  </action>
  <action acid="25" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="submenu" /> 
  <actionparam paramtype="value" paramvalue="Elenco rapporti" />  
  </action>
  <action acid="26" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="2" />  
  </action>
  
  <!--Open drawer-->
  <action acid="27" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div/div[2]/table/tbody/tr" />  
  </action>
  <action acid="28" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="2" />  
  </action>
  <!--Download file first-->
  <action acid="29" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div[3]/div/div/span[2]/a" />  
  </action>
  <action acid="30" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="10" />  
  </action>
  <!--Verify the downloaded file name and size-->
  <action acid="31" stoptype="abort" timeout="30">
  <actionname>verify</actionname> 
  <actionparam paramtype="type" paramvalue="filename" />   
  <actionparam paramtype="value" paramvalue="RPT_CUSTOMER_LIST.csv" />   
  </action>
  <action acid="32" stoptype="abort" timeout="30">
  <actionname>verify</actionname> 
  <actionparam paramtype="type" paramvalue="filesize" />   
  <actionparam paramtype="value" paramvalue="RPT_CUSTOMER_LIST.csv" />   
  </action> 

  	 <action acid="33" stoptype="abort" timeout="30">
  <actionname>managefile</actionname> 
  <actionparam paramtype="type" paramvalue="savefile" />   
  <actionparam paramtype="value" paramvalue="RPT_CUSTOMER_LIST.csv" />   
  </action> 
  <action acid="34" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="20" />  
  </action>
  
  <action acid="6666" stoptype="abort" timeout="30">
   <actionname>verify</actionname>
   <actionparam paramtype="type" paramvalue="verifycsv" />
   <actionparam paramtype="value" paramvalue="RPT_CUSTOMER_LIST.csv" />
   <actionparam paramtype="searchstring" paramvalue="Rapporto cliente" />
   </action>
<!--Delete the previous downloaded file-->
  <action acid="35" stoptype="abort" timeout="30">
  <actionname>managefile</actionname> 
  <actionparam paramtype="type" paramvalue="delete" />   
  <actionparam paramtype="value" paramvalue="RPT_CUSTOMER_LIST.csv" />   
  </action> 
 <action acid="36" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="5" />  
  </action>  
  
  <!--Verify whether the report has been added successfully-->  
  <action acid="37" stoptype="abort" timeout="30">
  <actionname>verify</actionname> 
  <actionparam paramtype="type" paramvalue="Text" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div/div[2]/table/tbody/tr/td[3]" />
  <actionparam paramtype="value" paramvalue="123abcABC" />   
  </action>
   
  <action acid="38" stoptype="abort" timeout="30">
  <actionname>verify</actionname> 
  <actionparam paramtype="type" paramvalue="Text" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div/div[2]/table/tbody/tr/td[5]" />
  <actionparam paramtype="value" paramvalue="CSV" />   
  </action>

  <action acid="39" stoptype="abort" timeout="30">
  <actionname>verify</actionname> 
  <actionparam paramtype="type" paramvalue="Text" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div/div[2]/table/tbody/tr/td[6]" />
  <actionparam paramtype="value" paramvalue="Italiano" />   
  </action>
  
   <!--Delete the report-->  
  <action acid="40" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div/div[2]/table/tbody/tr" />  
  </action>
  <action acid="41" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="2" />  
  </action>
  
  <!--Click the Delete-->
  <action acid="42" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="link" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div[3]/div/div/span[3]/a" />  
  </action>
  <action acid="43" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="1" />  
  </action>
  
  <!--Click the OK-->
  <action acid="44" stoptype="abort" timeout="30">
  <actionname>click</actionname> 
  <actionparam paramtype="type" paramvalue="button" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div[2]/div[3]/div/span/button" />  
  </action>  
  <action acid="45" stoptype="abort" timeout="30">
  <actionname>wait</actionname> 
  <actionparam paramtype="type" paramvalue="seconds" /> 
  <actionparam paramtype="value" paramvalue="1" />  
  </action>

  <!--Verify whether it is back to report page-->
  <action acid="46" stoptype="abort" timeout="30">
  <actionname>verify</actionname> 
  <actionparam paramtype="type" paramvalue="Text" /> 
  <actionparam paramtype="xpath" paramvalue="/html/body/div/div[2]/div/div/h2/span" />
  <actionparam paramtype="value" paramvalue="Report" />   
  </action>  
  
</workflow>
</testcase>
